(function(e){function t(t){for(var r,i,l=t[0],s=t[1],c=t[2],d=0,f=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),o=n.n(r);o.a},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("6b30"),n("450d");var r=n("c284"),o=n.n(r),a=(n("eca7"),n("3787")),i=n.n(a),l=(n("425f"),n("4105")),s=n.n(l),c=(n("1951"),n("eedf")),u=n.n(c),d=n("2b0e"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},p=[],m={name:"App"},v=m,h=(n("034f"),n("2877")),b=Object(h["a"])(v,f,p,!1,null,null,null),g=b.exports,k=n("8c4f"),D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"ruleForm",staticClass:"box",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[n("qrcode-drop-zone",{on:{detect:e.onDetect,dragover:e.onDragOver,init:e.logErrors}},[n("div",{staticClass:"drop-area",class:{dragover:e.dragover}},[e._v(" 将宁盾二维码图片拖动至此 ")])]),n("el-form-item",{attrs:{label:"宁盾URL",prop:"ndUrl",required:""}},[n("el-input",{model:{value:e.ruleForm.ndUrl,callback:function(t){e.$set(e.ruleForm,"ndUrl",t)},expression:"ruleForm.ndUrl"}})],1),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"令牌序号"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.tokenNo,callback:function(t){e.$set(e.tokenDetail,"tokenNo",t)},expression:"tokenDetail.tokenNo"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"公司名称"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.companyName,callback:function(t){e.$set(e.tokenDetail,"companyName",t)},expression:"tokenDetail.companyName"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"创建时间"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.createTime,callback:function(t){e.$set(e.tokenDetail,"createTime",t)},expression:"tokenDetail.createTime"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"过期时间"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.expireTime,callback:function(t){e.$set(e.tokenDetail,"expireTime",t)},expression:"tokenDetail.expireTime"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"密码长度"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.passwordLength,callback:function(t){e.$set(e.tokenDetail,"passwordLength",t)},expression:"tokenDetail.passwordLength"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"时间步进"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.timeStep,callback:function(t){e.$set(e.tokenDetail,"timeStep",t)},expression:"tokenDetail.timeStep"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"令牌版本"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.version,callback:function(t){e.$set(e.tokenDetail,"version",t)},expression:"tokenDetail.version"}})],1):e._e(),e.isTokenDetailVisible?n("el-form-item",{attrs:{label:"宁盾密钥"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.tokenDetail.seed,callback:function(t){e.$set(e.tokenDetail,"seed",t)},expression:"tokenDetail.seed"}})],1):e._e(),n("el-form-item",[n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onResolve("ruleForm")}}},[e._v("解析URL")])],1),n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1),n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{type:"plain"},on:{click:function(t){return e.go2Code()}}},[e._v("获取 Code")])],1)],1)],1)},y=[],w=n("5e05"),S=w["a"],x=(n("6b36"),Object(h["a"])(S,D,y,!1,null,"deb39c48",null)),T=x.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("Code :"+e._s(e.code))]),n("p",[e._v(" TODO: 详情待完善")]),n("el-progress",{attrs:{percentage:0}}),n("el-button",{attrs:{type:"primary"},on:{click:e.refreshCode}},[e._v("刷新2FA")]),n("el-button",{attrs:{type:"danger"},on:{click:e.resetCode}},[e._v("重置")])],1)},j=[],O=n("1abe"),F=n.n(O),$=n("17e1"),C=n.n($);function N(e){var t=E(e);return U(t)}function U(e){for(var t=[],n=0;n<e.length;n++)t[n/4|0]=t[n/4|0]|e[n]<<24-8*n;return C.a.create(t,e.length)}function V(e,t){var n=[],r=255;return t>0&&n.push(e>>>24),t>1&&n.push(e>>>16&r),t>2&&n.push(e>>>8&r),t>3&&n.push(e&r),n}function L(e){var t=e.sigBytes;e=e.words;var n,r=[],o=0;while(t>0)n=V(e[o],Math.min(4,t)),t-=n.length,r.push(n),o++;return[].concat.apply([],r)}function E(e){for(var t=[],n=7,r=e;n>=0;--n)t[n]=255&r,r>>=8;return t}function P(e){for(var t=e.split(""),n=[],r=0,o=0;r<t.length/2;r++){var a=parseInt(t[o],16);++o;var i=parseInt(t[o],16);++o,n[r]=a<<4|i}return n}function I(e){var t=Date.parse(Date())/1e3,n=t/60,r=N(n),o=U(P(e)),a=F()(r,o),i=L(a),l=15&i[i.length-1],s=i[l],c=i[l+1],u=i[l+2],d=i[l+3],f=(127&s)<<24,p=(255&c)<<16,m=(255&u)<<8,v=255&d,h=f|p|m|v,b=h%1e6;return b.toString().padStart(6,"0")}var M={name:"TokenDetail",data:function(){return{code:""}},created:function(){void 0===localStorage.ndKey?(this.resetCode(),this.go2Login()):this.code=I(localStorage.ndKey)},methods:{refreshCode:function(){this.code="",this.code=I(localStorage.ndKey)},resetCode:function(){localStorage.removeItem("ndKey"),localStorage.removeItem("ndUrl")},go2Login:function(){this.$router.replace("/login")}}},R=M,K=Object(h["a"])(R,_,j,!1,null,"1cc65b39",null),A=K.exports;d["default"].use(k["a"]);var q=new k["a"]({routes:[{path:"/",component:A},{path:"/login",component:T}]});d["default"].config.productionTip=!1,d["default"].use(u.a),d["default"].use(s.a),d["default"].use(i.a),d["default"].use(o.a),d["default"].config.devtools,new d["default"]({render:function(e){return e(g)},router:q}).$mount("#app")},"5e05":function(e,t,n){"use strict";(function(e){var r=n("9a3e");function o(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(c){return void n(c)}l.done?t(s):Promise.resolve(s).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function l(e){o(i,r,a,l,s,"next",e)}function s(e){o(i,r,a,l,s,"throw",e)}l(void 0)}))}}t["a"]={name:"TFACode",components:{QrcodeDropZone:r["QrcodeDropZone"]},data:function(){var e=this,t=function(t,n,r){e.verifySeed(n)?(localStorage.ndKey=e.json.token.seed,r()):r(Error("密钥有误，请重新输入"))};return{error:null,dragover:!1,isTokenDetailVisible:!1,ruleForm:{ndUrl:""},rules:{ndUrl:[{required:!0,message:"请输入宁盾二维码内容/宁盾BASE64/宁盾密钥",trigger:"blur"},{validator:t,trigger:"blur"}]},json:"",tokenDetail:{tokenNo:"",companyName:"",createTime:"",expireTime:"",timeStep:"",serviceId:"",seed:"",passwordLength:"",version:""}}},methods:{onDetect:function(e){var t=this;return a(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e;case 3:r=n.sent,o=r.content,t.ruleForm.ndUrl=o,localStorage.ndUrl=o,t.error=null,n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](0),"DropImageFetchError"===n.t0.name?t.error="Sorry, you can't load cross-origin images :/":"DropImageDecodeError"===n.t0.name?t.error="Ok, that's not an image. That can't be decoded.":t.error="Ups, what kind of error is this?! "+n.t0.message;case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},logErrors:function(e){e.catch(console.error)},onDragOver:function(e){this.dragover=e},dateFormat:function(e){var t=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t,"-").concat(n," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())},verifySeed:function(t){var n=!1;try{var r="";if(t.includes("http:")){if(t.includes("#")){var o=t.split("#")[1];r=e.from(o,"base64").toString()}}else r=e.from(t,"base64").toString();this.json=JSON.parse(r),n=!0}catch(a){n=!1}return n},fillData:function(){this.tokenDetail.tokenNo=this.json.token.serial,this.tokenDetail.companyName=this.json.companyName;var e=new Date(this.json.expireTime),t=new Date(e.setDate(e.getDate()-3));this.tokenDetail.createTime=this.dateFormat(t);var n=new Date(this.json.token.expireTime);this.tokenDetail.expireTime=this.dateFormat(n),this.tokenDetail.passwordLength=this.json.token.passwordLength,this.tokenDetail.timeStep=this.json.token.timeStep,this.tokenDetail.seed=this.json.token.seed,this.tokenDetail.version=this.json.version,this.isTokenDetailVisible=!0},onResolve:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.fillData()}))},resetForm:function(e){this.isTokenDetailVisible=!1,this.$refs[e].resetFields()},go2Code:function(){this.$router.replace("/")}}}}).call(this,n("b639").Buffer)},6:function(e,t){},"6b36":function(e,t,n){"use strict";var r=n("f8b9"),o=n.n(r);o.a},7:function(e,t){},8:function(e,t){},"85ec":function(e,t,n){},9:function(e,t){},f8b9:function(e,t,n){}});