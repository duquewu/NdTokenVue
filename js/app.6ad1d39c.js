(function(e){function t(t){for(var r,i,l=t[0],s=t[1],c=t[2],d=0,f=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),o=n.n(r);o.a},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("DIS")],1)},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isLogin?n("div",[n("token-detail")],1):n("div",[n("t-f-a-code")],1)},l=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("Code :"+e._s(e.code))]),n("p",[e._v(" TODO: 详情待完善")]),n("el-progress",{attrs:{percentage:"0.2"}}),n("el-button",{attrs:{type:"primary"},on:{click:e.refreshCode}},[e._v("刷新2FA")]),n("el-button",{attrs:{type:"danger"},on:{click:e.resetCode}},[e._v("重置")])],1)},c=[],u=n("6434"),d={name:"TokenDetail",data:function(){return{code:Object(u["a"])(localStorage.ndKey)}},methods:{refreshCode:function(){this.code="",this.code=Object(u["a"])(localStorage.ndKey)},resetCode:function(){localStorage.ndKey=null,localStorage.ndUrl=null}}},f=d,p=n("2877"),m=Object(p["a"])(f,s,c,!1,null,"17be30e0",null),v=m.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"ruleForm",staticClass:"box",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[n("qrcode-drop-zone",{on:{detect:e.onDetect,dragover:e.onDragOver,init:e.logErrors}},[n("div",{staticClass:"drop-area",class:{dragover:e.dragover}},[e._v(" 将宁盾二维码图片拖动至此 ")])]),n("el-form-item",{attrs:{label:"宁盾URL",prop:"ndUrl",required:""}},[n("el-input",{model:{value:e.ruleForm.ndUrl,callback:function(t){e.$set(e.ruleForm,"ndUrl",t)},expression:"ruleForm.ndUrl"}})],1),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"令牌序号"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.tokenNo,callback:function(t){e.$set(e.tokenDetail,"tokenNo",t)},expression:"tokenDetail.tokenNo"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"公司名称"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.companyName,callback:function(t){e.$set(e.tokenDetail,"companyName",t)},expression:"tokenDetail.companyName"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"创建时间"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.createTime,callback:function(t){e.$set(e.tokenDetail,"createTime",t)},expression:"tokenDetail.createTime"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"过期时间"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.expireTime,callback:function(t){e.$set(e.tokenDetail,"expireTime",t)},expression:"tokenDetail.expireTime"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"密码长度"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.passwordLength,callback:function(t){e.$set(e.tokenDetail,"passwordLength",t)},expression:"tokenDetail.passwordLength"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"时间步进"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.timeStep,callback:function(t){e.$set(e.tokenDetail,"timeStep",t)},expression:"tokenDetail.timeStep"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"令牌版本"}},[n("el-input",{attrs:{disabled:""},model:{value:e.tokenDetail.version,callback:function(t){e.$set(e.tokenDetail,"version",t)},expression:"tokenDetail.version"}})],1):e._e(),e.ruleForm.isTokenDetailVisible?n("el-form-item",{attrs:{label:"宁盾密钥"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.tokenDetail.seed,callback:function(t){e.$set(e.tokenDetail,"seed",t)},expression:"tokenDetail.seed"}})],1):e._e(),n("el-form-item",[n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("ruleForm")}}},[e._v("获取 2FA")])],1),n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1),n("el-col",{attrs:{span:8}},[n("el-form-item",[e._v(" Code: "+e._s(e.ruleForm.code)+" ")])],1)],1)],1)},h=[],k=n("5e05"),g=k["a"],D=(n("8a43"),Object(p["a"])(g,b,h,!1,null,"21f06a32",null)),y=D.exports,S={name:"Dispacher",data:function(){return{isLogin:!(null===localStorage.ndUrl)}},components:{TFACode:y,TokenDetail:v}},F=S,_=Object(p["a"])(F,i,l,!1,null,"eb2e60a8",null),x=_.exports,T={name:"App",components:{DIS:x}},w=T,j=(n("034f"),Object(p["a"])(w,o,a,!1,null,null,null)),O=j.exports,$=n("5c96"),N=n.n($),U=(n("0fae"),n("9a3e"));r["default"].config.productionTip=!1,r["default"].use(N.a),r["default"].use(U["default"]),r["default"].config.devtools,new r["default"]({render:function(e){return e(O)}}).$mount("#app")},"5e05":function(e,t,n){"use strict";(function(e){n("99af"),n("caad"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("2532"),n("4d90"),n("1276"),n("96cf");var r=n("1da1"),o=n("6434");t["a"]={name:"TFACode",data:function(){var e=this,t=function(t,n,r){e.verifySeed(n)?(localStorage.ndKey=e.json.token.seed,r()):r(Error("密钥有误，请重新输入"))};return{error:null,dragover:!1,ruleForm:{ndUrl:"",code:"",isTokenDetailVisible:!1},rules:{ndUrl:[{required:!0,message:"请输入宁盾二维码内容/宁盾BASE64/宁盾密钥",trigger:"blur"},{validator:t,trigger:"blur"}]},json:"",tokenDetail:{tokenNo:"",companyName:"",createTime:"",expireTime:"",timeStep:"",serviceId:"",seed:"",passwordLength:"",version:""}}},methods:{onDetect:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e;case 3:r=n.sent,o=r.content,t.ruleForm.ndUrl=o,localStorage.ndUrl=o,t.error=null,n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](0),"DropImageFetchError"===n.t0.name?t.error="Sorry, you can't load cross-origin images :/":"DropImageDecodeError"===n.t0.name?t.error="Ok, that's not an image. That can't be decoded.":t.error="Ups, what kind of error is this?! "+n.t0.message;case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},logErrors:function(e){e.catch(console.error)},onDragOver:function(e){this.dragover=e},dateFormat:function(e){var t=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t,"-").concat(n," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())},verifySeed:function(t){var n=!1;try{var r="";if(t.includes("http:")){if(t.includes("#")){var o=t.split("#")[1];r=e.from(o,"base64").toString()}}else r=e.from(t,"base64").toString();this.json=JSON.parse(r),n=!0}catch(a){n=!1}return n},fillData:function(){this.tokenDetail.tokenNo=this.json.token.serial,this.tokenDetail.companyName=this.json.companyName;var e=new Date(this.json.expireTime),t=new Date(e.setDate(e.getDate()-3));this.tokenDetail.createTime=this.dateFormat(t);var n=new Date(this.json.token.expireTime);this.tokenDetail.expireTime=this.dateFormat(n),this.tokenDetail.passwordLength=this.json.token.passwordLength,this.tokenDetail.timeStep=this.json.token.timeStep,this.tokenDetail.seed=this.json.token.seed,this.tokenDetail.version=this.json.version,this.ruleForm.isTokenDetailVisible=!0},onSubmit:function(e){var t=this;console.log(111),this.$refs[e].validate((function(e){if(!e)return console.log("bbb"),!1;t.fillData(),t.ruleForm.code=Object(o["a"])(t.tokenDetail.seed)}))},resetForm:function(e){this.$refs[e].resetFields()}}}}).call(this,n("b639").Buffer)},6:function(e,t){},6434:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n("99af"),n("d3b7"),n("ac1f"),n("25f0"),n("4d90"),n("1276");var r=n("1abe"),o=n.n(r),a=n("17e1"),i=n.n(a);function l(e){var t=d(e);return s(t)}function s(e){for(var t=[],n=0;n<e.length;n++)t[n/4|0]=t[n/4|0]|e[n]<<24-8*n;return i.a.create(t,e.length)}function c(e,t){var n=[],r=255;return t>0&&n.push(e>>>24),t>1&&n.push(e>>>16&r),t>2&&n.push(e>>>8&r),t>3&&n.push(e&r),n}function u(e){var t=e.sigBytes;e=e.words;var n,r=[],o=0;while(t>0)n=c(e[o],Math.min(4,t)),t-=n.length,r.push(n),o++;return[].concat.apply([],r)}function d(e){for(var t=[],n=7,r=e;n>=0;--n)t[n]=255&r,r>>=8;return t}function f(e){for(var t=e.split(""),n=[],r=0,o=0;r<t.length/2;r++){var a=parseInt(t[o],16);++o;var i=parseInt(t[o],16);++o,n[r]=a<<4|i}return n}function p(e){var t=Date.parse(Date())/1e3,n=t/60,r=l(n),a=s(f(e)),i=o()(r,a),c=u(i),d=15&c[c.length-1],p=c[d],m=c[d+1],v=c[d+2],b=c[d+3],h=(127&p)<<24,k=(255&m)<<16,g=(255&v)<<8,D=255&b,y=h|k|g|D,S=y%1e6;return S.toString().padStart(6,"0")}},7:function(e,t){},8:function(e,t){},"85ec":function(e,t,n){},"8a43":function(e,t,n){"use strict";var r=n("cd39"),o=n.n(r);o.a},9:function(e,t){},cd39:function(e,t,n){}});